<!HTML DOCTYPE>
<html>
	<head>
		<title>yjblogv4</title>
		<link rel="stylesheet" href="../css/index.css" type="text/css" />
		<script src="../js/jquery-2.0.3.min.js"></script>
		<script src="../js/primitive.js"></script>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
	</head>
	<body>
		<!-- <img src="../imgs/bg3.jpg"/> -->
		<div class="xixi">嘻嘻</div>
		<div id="container"></div>
	</body>	
	<script>
		var winH = $(window).height();
		$(".xixi").click(function(){
			var Canvas = PRIMITIVE.Canvas;    
			var Optimizer = PRIMITIVE.Optimizer;
			var cfg = {
				alpha: 0.5,
				computeSize: 256,
				fill: "rgb(0, 0, 0)",
				height: 1438*winH/1080 ,
				mutateAlpha: true,
				shapeTypes: [PRIMITIVE.shapeMap.triangle],
				mutations: 30,
				shapes: 200,
				steps: 100,
				viewSize: 100,
				width: winH,
				scale:1,
			};
			
			function go(original, cfg) {
				let optimizer = new Optimizer(original, cfg);
			
				let cfg2 = Object.assign({}, cfg, {width:cfg.scale*cfg.width, height:cfg.scale*cfg.height});
				let result = Canvas.empty(cfg2, false);
				result.ctx.scale(cfg.scale, cfg.scale);
				document.getElementById('container').appendChild(result.node);

				optimizer.onStep = (step) => {
					if (step) {
						result.drawStep(step);
					}
				};
				optimizer.start();
			}
			
			Canvas.original('../imgs/xh.jpg', cfg).then(original => go(original, cfg));
		})
	</script>
</html>
